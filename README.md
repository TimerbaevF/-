# Использование алгоритмов машинного обучения для предсказания потребности в медицинских услугах в различных регионах (Лабораторная №1)

# Цель лабораторной работы:
**Исследовать и провести анализ данных медицинских расходов с использованием алгоритмов машинного обучения для предсказания потребности в медицинских услугах в различных регионах:**

Исследование структуры данных: Провести разведочный анализ данных, включая изучение распределения признаков, корреляций между ними, анализ выбросов и т.д.

Визуализация данных: Использовать графические методы для визуализации зависимостей между различными переменными, чтобы получить представление о структуре данных.

Статистический анализ: Применить статистические методы для проверки гипотез и выявления взаимосвязей между переменными.

Модель предсказания на основе курения: Использовать модель машинного обучения для предсказания медицинских расходов в зависимости от курения.

Оценка качества модели: Оценить качество модели с использованием метрик, таких как **R-squared**, чтобы определить, насколько успешно модель предсказывает медицинские расходы.

Лабораторная работа в данном случае предполагает практическое применение методов анализа данных и машинного обучения для извлечения информации из предоставленного набора данных и получения инсайтов в области медицинских расходов.
# Использование
**Kaggle**
https://www.kaggle.com/code/timka01/the-need-for-medical-services/edit/run/156567718

Чтобы использовать этот код и провести эксперименты с различными функциями активации, выполните следующие шаги:
Скачть датасет под названием **insurance.csv**, который находиться выше.

**Загружаем датасет**


![image](https://github.com/TimerbaevF/-/assets/114729066/64ec34c8-2d97-4311-8cce-cac243685ce7)

**Имортируем библиотеки**


![image](https://github.com/TimerbaevF/-/assets/114729066/a845ee8f-4981-4d17-90f7-0c8c19cc5755)

   **используемые библиотеки**

   **NumPy (import numpy as np):**
    Цель использования: NumPy предоставляет функциональность для работы с многомерными массивами и матрицами, что делает его основной библиотекой для выполнения операций линейной алгебры в Python.
    
   **Pandas (import pandas as pd):**
    Цель использования: Pandas предоставляет структуры данных и функции для эффективной работы с табличными данными. DataFrame в Pandas используется для хранения и манипуляции данными.
    
   **Matplotlib (import matplotlib.pyplot as plt):**
    Цель использования: Matplotlib используется для создания визуализаций данных. В данном коде используется для построения различных графиков, таких как pair plot, bar plot, scatter plot и т.д.
    
   **Seaborn (import seaborn as sb):**
    Цель использования: Seaborn — это библиотека для красивой визуализации данных на основе Matplotlib. Она упрощает создание информативных и привлекательных графиков. В коде используется для создания pair plot,     bar plot, heatmap и других графиков.
    
   **Statsmodels (import statsmodels.api as sm):**
    Цель использования: Statsmodels предоставляет классы и функции для оценки статистических моделей. В данном коде используется для выполнения множественной линейной регрессии с использованием метода OLS (Метод     наименьших квадратов).
    
   **Scikit-Learn (from sklearn...):**
    Цель использования: Scikit-Learn предоставляет множество инструментов для машинного обучения и анализа данных. В коде используется для разделения данных на обучающие и тестовые наборы, стандартизации значений, обучения линейной регрессии и оценки качества модели.

**Считываем датасет**

![image](https://github.com/TimerbaevF/-/assets/114729066/ea17d3a6-bd45-4f82-b88b-4a3cf3735e35)

## Результаты и Выводы
Проведен анализ на основе жителей разных регионов по потребностям в медицинских услугах.
![image](https://github.com/TimerbaevF/-/assets/114729066/ebf42f89-a5f2-4991-aab8-9e0e31c7af56)

Проведя анализ по регионам и тратам и возрасту, могу сказать регион не имеет значения.

![image](https://github.com/TimerbaevF/-/assets/114729066/5e16f447-45aa-40d2-8b0d-8e9a11f005bd)
![image](https://github.com/TimerbaevF/-/assets/114729066/44214ab5-b3f9-40d8-8891-2cf424971edd)

**Так как регион не нужен решил удаление столбца Region**

![image](https://github.com/TimerbaevF/-/assets/114729066/6bf1e44b-1406-4b65-9530-9dda42f27458)

**Импорт стандартного scaler для стандартизации значений**

![image](https://github.com/TimerbaevF/-/assets/114729066/5cea3efc-1e36-4fe7-a723-2b63a00f38a8)

![image](https://github.com/TimerbaevF/-/assets/114729066/ad3a1cc9-2a20-4e6c-914f-41a0b2eddec2)

![image](https://github.com/TimerbaevF/-/assets/114729066/236b699e-a15e-40b1-a0fa-ceb4880754aa)

![image](https://github.com/TimerbaevF/-/assets/114729066/899ba09a-f449-421f-839a-fdf8eae226c6)

**Оценить качество модели с использованием метрик, таких как R-squared, чтобы определить, насколько успешно модель предсказывает медицинские расходы.**

# Методы и модели, реализованные в коде

 1 **Методы анализа данных:**
Отображение данных: Импорт и отображение основных столбцов из набора данных, включая возраст, пол, ИМТ, количество детей, информацию о курении, регион проживания и медицинские расходы.
Описательная статистика: Вывод описательной статистики, включая среднее, медиану, стандартное отклонение и квартили для каждого числового столбца.

 2 **Визуализация данных:**
Pair Plot: Построение pair plot для визуального анализа взаимосвязей между различными числовыми признаками в зависимости от количества детей.
Bar Plot: Построение bar plot, показывающего количество курильщиков по регионам.
Bar Plot: Построение bar plot, показывающего распределение числа детей пациентов в зависимости от возраста и пола.
Scatter Plot: Построение scatter plot для оценки влияния возраста на медицинские расходы.
Scatter Plot: Построение scatter plot для анализа распределения ИМТ в зависимости от возраста и пола.
Heatmap: Построение тепловой карты для визуализации корреляции между числовыми признаками.

 3 **Статистический анализ:**
Множественная линейная регрессия: Использование библиотеки Statsmodels для выполнения множественной линейной регрессии с использованием метода наименьших квадратов (OLS).

 4 **Машинное обучение:**
Linear Regression (Scikit-Learn): Использование библиотеки Scikit-Learn для построения и обучения модели линейной регрессии для предсказания медицинских расходов в зависимости от курения.

 5 **Оценка качества модели:**
R-squared: Вычисление значения R-squared для оценки качества предсказаний модели.
